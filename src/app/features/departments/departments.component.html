<div class="page-wrap">
  <div class="page-shell">
    <!-- Header -->
    <div class="head-row">
      <h2 class="title">Departments</h2>

      <div class="actions">
        <input
          class="search"
          type="text"
          placeholder="Search departments"
          (input)="onSearch($event.target.value)"
        />
        <button class="btn mint" type="button" (click)="openAdd()">+ Add</button>
      </div>
    </div>

    <!-- Table -->
    <div class="table glassy">
      <div class="thead row">
        <div class="th">ID</div>
        <div class="th">Name</div>

        <div class="th center">
          <div>Employees</div>
          <small class="muted">Candidates</small>
        </div>

        <div class="th right">Actions</div>
      </div>

      <ng-container *ngIf="rows && rows.length; else emptyState">
        <div class="row tr" *ngFor="let r of rows; trackBy: trackById">
          <div class="td">{{ r.id }}</div>
          <div class="td">{{ r.name }}</div>

          <div class="td center">
            <div>{{ r.empCount }}</div>
            <small class="muted">{{ r.candCount }}</small>
          </div>

          <div class="td right">
            <button class="btn" type="button" (click)="openDetail(r.id)">View</button>
          </div>
        </div>
      </ng-container>

      <ng-template #emptyState>
        <div class="row">
          <div class="td" style="grid-column:1 / -1; opacity:.7; padding:16px;">
            Select a department to view its employees and candidates.
          </div>
        </div>
      </ng-template>
    </div>

    <!-- Detail section -->
    <!-- Detail section -->
<div class="detail-wrap" *ngIf="detailFor">
  <div class="detail-head">
    <h3 class="detail-title">Department: {{ detailFor?.name }}</h3>
    <button class="link" type="button" (click)="clearDetail()">Clear</button>
  </div>

  <div class="detail-grids">
    <!-- Employees -->
    <div class="card glassy">
      <div class="card-title">Employees</div>
      <div class="mini-table emps">
        <div class="mini-head mini-row">
          <div class="mini-th">ID</div>
          <div class="mini-th">Name</div>
          <div class="mini-th">Email</div>
          <div class="mini-th">Hire Date</div>
          <div class="mini-th">Role</div>
        </div>

        <div class="mini-row" *ngFor="let e of detailEmployeesV">
          <div class="mini-td">{{ e.id }}</div>
          <div class="mini-td">{{ e.displayName }}</div>
          <div class="mini-td">{{ e.email || '—' }}</div>
          <div class="mini-td">{{ e.hireDate || '—' }}</div>
          <div class="mini-td">{{ e.role || '—' }}</div>
        </div>

        <div class="mini-row" *ngIf="!detailEmployeesV?.length">
          <div class="mini-td muted" style="grid-column:1 / -1;">No employees.</div>
        </div>
      </div>
    </div>

    <!-- Candidates -->
    <div class="card glassy">
      <div class="card-title">Candidates</div>
      <div class="mini-table cands">
        <div class="mini-head mini-row">
          <div class="mini-th">ID</div>
          <div class="mini-th">Name</div>
          <div class="mini-th">Email</div>
          <div class="mini-th">Status</div>
        </div>

        <div class="mini-row" *ngFor="let c of detailCandidatesV">
          <div class="mini-td">{{ c.id }}</div>
          <div class="mini-td">{{ c.displayName }}</div>
          <div class="mini-td">{{ c.email || '—' }}</div>
          <div class="mini-td">{{ c.status || '—' }}</div>
        </div>

        <div class="mini-row" *ngIf="!detailCandidatesV?.length">
          <div class="mini-td muted" style="grid-column:1 / -1;">No candidates.</div>
        </div>
      </div>
    </div>
  </div>
</div>


  </div>
</div>

<!-- Add modal -->
<div class="modal-backdrop" *ngIf="modalOpen" (click)="closeModal()">
  <div class="modal glassy" (click)="$event.stopPropagation()">
    <div class="modal-head">
      <h3 class="modal-title">Add Department</h3>
    </div>

    <form (ngSubmit)="saveDepartment()" class="modal-body">
      <div class="form-row">
        <label>Name</label>
        <input class="field" type="text" [(ngModel)]="newDeptName" name="deptName" required />
      </div>

      <div class="modal-actions">
        <button type="button" class="btn" (click)="closeModal()">Cancel</button>
        <button type="submit" class="btn mint" [disabled]="modalSaving">Create</button>
      </div>
    </form>
  </div>
</div>
