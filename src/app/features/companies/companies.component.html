<!-- Companies Page -->
<div class="page-wrap">
  <div class="page-shell">
    <!-- Top bar -->
    <div class="bar glassy">
      <div class="search">
        <span class="icon" aria-hidden="true">üîé</span>
        <input
          type="text"
          placeholder="Search companies"
          [(ngModel)]="searchTerm"
          (input)="filtered = filterNow(searchTerm)" />
      </div>

      <button type="button" class="btn add" (click)="openAdd()">
        <span class="plus" aria-hidden="true">Ôºã</span>
        Add
      </button>
    </div>

    <!-- Table -->
    <div class="table glassy" role="table" aria-label="Companies">
      <div class="row thead" role="row">
        <div class="th" role="columnheader">ID</div>
        <div class="th" role="columnheader">Name</div>
        <div class="th" role="columnheader">Location</div>
        <div class="th actions" role="columnheader">Actions</div>
      </div>

      <ng-container *ngIf="(filtered || companies)?.length; else emptyCompanies">
        <div
          class="row"
          role="row"
          *ngFor="let c of (filtered || companies); trackBy: trackById">
          <div class="td" role="cell">{{ c.id }}</div>
          <div class="td" role="cell">{{ c.name }}</div>
          <div class="td" role="cell">{{ c.location }}</div>
          <div class="td actions" role="cell">
            <button class="chip blue" type="button" (click)="openEdit(c)" aria-label="Edit company">
              ‚úè
            </button>
            <button class="chip red" type="button" (click)="confirmDelete(c)" aria-label="Delete company">
              üóë
            </button>
          </div>
        </div>
      </ng-container>

      <ng-template #emptyCompanies>
        <div class="row" role="row">
          <div class="td" role="cell" style="grid-column: 1 / -1; opacity:.7; padding:22px;">
            No companies found.
          </div>
        </div>
      </ng-template>
    </div>
  </div>
</div>

<!-- Add / Edit Modal -->
<div class="glass-modal-overlay" *ngIf="modalOpen" (click)="closeModal()">
  <div class="glass-modal" (click)="$event.stopPropagation()">
    <h3 class="modal-title">{{ modalMode === 'add' ? 'Add Company' : 'Edit Company' }}</h3>

    <form class="modal-form" (ngSubmit)="saveForm()" #companyForm="ngForm">
      <div class="form-row">
        <label for="cName">Name</label>
        <input
          id="cName"
          class="field"
          type="text"
          name="name"
          required
          [(ngModel)]="formCompany.name" />
      </div>

      <div class="form-row">
        <label for="cLoc">Location</label>
        <input
          id="cLoc"
          class="field"
          type="text"
          name="location"
          required
          [(ngModel)]="formCompany.location" />
      </div>

      <div class="modal-actions">
        <button type="button" class="btn ghost" (click)="closeModal()">Cancel</button>
        <button
          type="submit"
          class="btn mint"
          [disabled]="modalSaving || !formCompany?.name?.trim() || !formCompany?.location?.trim()">
          {{ modalMode === 'add' ? 'Create' : 'Save' }}
        </button>
      </div>
    </form>
  </div>
</div>
